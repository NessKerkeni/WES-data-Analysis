###Alignment 

#Dowload the reference sequence
$ wget http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz
$ gunzip hg38.fa.gz

#Building index
$ bowtie2-build hg38.fa hg38

#Sequence Alignment/Map format fil
$ bowtie2 -x hg38 -1 input-F.fastq -2 input-R.fastq -U hg38.fa -S output.sam

#Convert the SAM file to a BAM file
$ java -jar picard.jar SortSam --INPUT=input.sam --OUTPUT=output_sorted.bam --SORT_ORDER=coordinate

#Alignement Symmary
$ java -jar picard.jar CollectAlignmentSummaryMetrics --REFERENCE_SEQUENCE=hg38.fa --INPUT=input_sorted.bam --OUTPUT=output_alignment_metrics.txt

#Insert size information
$ java -jar picard.jar AddOrReplaceReadGroups --INPUT=input_sorted.bam --OUTPUT=output_readgroup.bam --RGLB=lib1 --RGPL=illumina --RGPU=NONE --RGSM=BG

#Marking duplicates
$ java -jar picard.jar MarkDuplicates --INPUT=input_readgroup.bam --OUTPUT=output_dedup_reads.bam --METRICS_FILE=metrics.txt -AS=true --VALIDATION_STRINGENCY=LENIENT

#Indexing BAM file (output_dedup_reads.bam.bai)
$ java -jar picard.jar BuildBamIndex --INPUT=input_dedup_reads.bam

###Variant Calling
#Germline variant calling - HaplotypeCaller
$ gatk HaplotypeCaller -R hg38.fa --input inout_dedup_reads.bam --output output_raw_variants.vcf

#Filter the vcf file
$ gatk VariantFiltration -R hg38.fa -V output_raw_variants.vcf -O output_raw_variants_filtred.vcf --cluster-window-size 10 --filter-expression "MQ < 40.0" --filter-name "POOR MAPPING QUALITY" --filter-expression "MQ0 >= 4 && ((MQ0 / (1.0 * DP)) > 0.1)" --filter-name "HARD_TO_VALIDATE" --filter-expression "DP < 10" --filter-name "LowCoverage" --filter-expression "QUAL < 30.0 " --filter-name "VeryLowQual" --filter-expression "QUAL > 30.0 && QUAL < 50.0 " --filter-name "LowQual" --filter-expression "FS > 40.0" --filter-name "StrandBias" --filter-expression "QD<2.0||FS>60.0||MQ<40.0||HaplotypeScore>13.0||MQRankSum<-12.5||ReadPosRankSum<-8.0" --filter-name "SNP_FILTERS" --filter-expression "QD<2.0||FS>200.0||ReadPosRankSum<-20.0" --filter-name "INDEL_FILTERS"

###and then you can input the output_raw_variants_filtred.vcf file to varaft software (free software) fo annotation and fitration
